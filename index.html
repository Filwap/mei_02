<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <title>èµ ä¸bbğŸ·çš„ä¸€å°æƒ…ä¹¦</title>
    <link rel="icon" type="image/x-icon" href="https://i.loli.net/2021/06/03/lFg2V4WUcmkB98G.png">
    <meta name="language" content="zh-CN">
    <meta name="title" content="å°æ¢…åŒå­¦">
    <style>
        @media screen and (max-width: 428px) {
            #main {
                width: 100% !important;
                height: 100vh !important;
                overflow: hidden;
            }
            #wrap {
                width: 100% !important;
                height: 100vh !important;
                margin-top: 0 !important;
            }
            #text {
                width: 90% !important;
                height: auto !important;
                left: 5% !important;
                top: 50px !important;
                z-index: 2;
            }
            #code {
                font-size: 18px !important;
                line-height: 1.6 !important;
                background: rgba(255, 255, 255, 0.85) !important;
                padding: 20px !important;
                border-radius: 15px !important;
            }
            .say {
                font-size: 20px !important;
                margin-bottom: 10px !important;
                display: block !important;
            }
            #clock-box {
                width: 90% !important;
                left: 5% !important;
                bottom: 30px !important;
                top: auto !important;
                font-size: 16px !important;
                background: rgba(255, 255, 255, 0.85) !important;
                padding: 15px !important;
                border-radius: 15px !important;
                text-align: center !important;
            }
            #clock {
                margin-left: 0 !important;
                font-size: 24px !important;
            }
            #canvas {
                position: fixed !important;
                top: 0 !important;
                left: 0 !important;
                width: 100% !important;
                height: 100% !important;
                z-index: 1 !important;
            }
            .space {
                margin-right: 0 !important;
            }
        }
    </style>
    <link type="text/css" rel="stylesheet" href="./Love_files/default.css">
    <script type="text/javascript" src="./Love_files/jquery.min.js"></script>
    <script type="text/javascript" src="./Love_files/jscex.min.js"></script>
    <script type="text/javascript" src="./Love_files/jscex-parser.js"></script>
    <script type="text/javascript" src="./Love_files/jscex-jit.js"></script>
    <script type="text/javascript" src="./Love_files/jscex-builderbase.min.js"></script>
    <script type="text/javascript" src="./Love_files/jscex-async.min.js"></script>
    <script type="text/javascript" src="./Love_files/jscex-async-powerpack.min.js"></script>
    <script type="text/javascript" src="./Love_files/functions.js" charset="utf-8"></script>
    <script type="text/javascript" src="./Love_files/love.js" charset="utf-8"></script>

</head>

<body>
    <div id="main">
        <div id="error">äº²ï¼Œæ‚¨ä½¿ç”¨çš„æµè§ˆå™¨æ— æ³•æ”¯æŒå³å°†æ˜¾ç¤ºçš„å†…å®¹ï¼Œè¯·æ¢æˆè°·æ­Œ(<a
                href="http://www.google.cn/chrome/intl/zh-CN/landing_chrome.html?hl=zh-CN&brand=CHMI">Chrome</a>)æˆ–è€…ç«ç‹(<a
                href="http://firefox.com.cn/download/">Firefox</a>)æµè§ˆå™¨å“Ÿ~</div>
        <div id="wrap">
            <div id="text">
                <div id="code">
                    <span class="say">Dear bbğŸ·</span><br><br>
                    <span class="say">ç«ç‘°é€ä½ æ‰æµªæ¼«</span><br>
                    <span class="say">æ—¥è½å’Œä½ æ‰å¥½çœ‹</span><br>
                    <span class="say">æ˜¯å¾®é£</span><br>
                    <span class="say">æ˜¯æ™šéœ</span><br>
                    <br>
                    <span class="say">æ˜¯å¿ƒè·³ä¸æ­¢</span><br>
                    <span class="say">æ˜¯æ— å¯æ›¿ä»£</span><br>
                    <span class="say">æ²¡åˆ«çš„æ„æ€</span><br>
                    <span class="say">å°±æ˜¯å€Ÿç€ç‰¹æ®Šçš„æ—¥å­</span><br>
                    <span class="say">è¯´å£°æˆ‘çˆ±ä½ â¤</span><br>
                    <br>
                    <span class="say">åœ¨è¿™ä¸ªçˆ±æ„éšé£èµ·çš„å¹´ä»£</span><br>
                    <span class="say">æˆ‘æƒ³å’Œä½ æ…¢æ…¢æ¥</span><br>
                    <span class="say">å¸Œæœ›æˆ‘ä»¬æ°¸è¿œæ˜¯å½¼æ­¤çš„åº•æ°”</span><br>
                    <span class="say">è¢«çˆ±ã€è¢«æƒ¦è®°ã€è¢«ç†è§£</span><br>
                    <span class="say">æ°¸è¿œæ˜¯äººç”Ÿä¸‰å¤§å¹¸äº‹â¤</span><br>
                    <br>
                    <span class="say"><span class="space"></span> -- Your å°ç‹—</span>
                </div>
            </div>
            <div id="clock-box">
                <a href="www.haomei.fun" target="_blank">å°çŒ«</a> å’Œ <a href="www.haomei.fun"
                    target="_blank">å°ç‹—</a> åœ¨ä¸€èµ·çš„
                <div id="clock"></div>
            </div>
            <canvas id="canvas" width="1100" height="680"></canvas>
        </div>

    </div>

    <!-- éŸ³é¢‘å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
    <audio id="media" loop></audio>
    
    <div id="loading" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); 
         background: rgba(255, 255, 255, 0.9); padding: 20px; border-radius: 10px; 
         text-align: center; display: none; z-index: 999;">
        åŠ è½½ä¸­... <span id="progress">0</span>%
    </div>
    
    <script>
        // éŸ³ä¹æ§åˆ¶ç›¸å…³ä»£ç 
        document.addEventListener('DOMContentLoaded', function() {
            var audio = document.getElementById('media');
            var loadingDiv = document.getElementById('loading');
            var progressSpan = document.getElementById('progress');
            
            // å»¶è¿ŸåŠ è½½éŸ³é¢‘
            function loadAudio() {
                var xhr = new XMLHttpRequest();
                xhr.open('GET', 'CMJ - æ˜Ÿæ˜Ÿåœ¨å”±æ­Œï¼ˆçº¯éŸ³ä¹ï¼‰.mp3', true);
                xhr.responseType = 'blob';
                
                xhr.onprogress = function(e) {
                    if (e.lengthComputable) {
                        var percentComplete = Math.round((e.loaded / e.total) * 100);
                        progressSpan.textContent = percentComplete;
                    }
                };
                
                xhr.onload = function() {
                    if (xhr.status === 200) {
                        var blob = xhr.response;
                        var url = URL.createObjectURL(blob);
                        audio.src = url;
                        loadingDiv.style.display = 'none';
                    }
                };
                
                xhr.send();
            }
            
            // å½“ç”¨æˆ·ç‚¹å‡»é¡µé¢æ—¶åŠ è½½éŸ³é¢‘
            document.addEventListener('click', function loadOnFirstClick() {
                loadingDiv.style.display = 'block';
                loadAudio();
                document.removeEventListener('click', loadOnFirstClick);
            }, { once: true });
            
            // æ£€æµ‹æ˜¯å¦æ˜¯å¾®ä¿¡æµè§ˆå™¨
            function isWechat() {
                var ua = navigator.userAgent.toLowerCase();
                return ua.match(/MicroMessenger/i) == "micromessenger";
            }
            
            // ç¡®ä¿éŸ³é¢‘å¾ªç¯æ’­æ”¾
            audio.loop = true;
            
            // ç›‘å¬éŸ³é¢‘ç»“æŸäº‹ä»¶ï¼Œç¡®ä¿å¾ªç¯æ’­æ”¾
            audio.addEventListener('ended', function() {
                this.currentTime = 0;
                this.play();
            }, false);
            
            // å°è¯•è‡ªåŠ¨æ’­æ”¾éŸ³ä¹
            function attemptAutoplay() {
                // å°è¯•æ’­æ”¾
                audio.play().then(function() {
                    console.log('è‡ªåŠ¨æ’­æ”¾æˆåŠŸ');
                }).catch(function(err) {
                    console.log('è‡ªåŠ¨æ’­æ”¾å¤±è´¥:', err);
                    
                    // å¦‚æœè‡ªåŠ¨æ’­æ”¾å¤±è´¥ï¼Œå°è¯•ä½¿ç”¨å¾®ä¿¡JSSDKï¼ˆå¦‚æœåœ¨å¾®ä¿¡ä¸­ï¼‰
                    if (isWechat() && typeof WeixinJSBridge !== 'undefined') {
                        WeixinJSBridge.invoke('getNetworkType', {}, function(e) {
                            audio.play();
                        });
                    } else {
                        // åˆ›å»ºä¸€ä¸ªä¸€æ¬¡æ€§çš„è§¦æ‘¸äº‹ä»¶ç›‘å¬å™¨
                        document.addEventListener('touchstart', function playOnTouch() {
                            audio.play();
                            document.removeEventListener('touchstart', playOnTouch);
                        }, { once: true });
                    }
                });
            }
            
            // ç›‘å¬WeixinJSBridgeå‡†å¤‡å°±ç»ª
            if (isWechat()) {
                if (typeof WeixinJSBridge === 'undefined') {
                    document.addEventListener('WeixinJSBridgeReady', attemptAutoplay, false);
                } else {
                    attemptAutoplay();
                }
            } else {
                attemptAutoplay();
            }
            
            // æ·»åŠ é¡µé¢å¯è§æ€§å˜åŒ–ç›‘å¬ï¼Œè§£å†³é¡µé¢åˆ‡æ¢åéŸ³ä¹åœæ­¢çš„é—®é¢˜
            document.addEventListener('visibilitychange', function() {
                if (!document.hidden && !audio.paused) {
                    audio.play();
                }
            });
        });

        (function () {
            var canvas = $('#canvas');

            if (!canvas[0].getContext) {
                $("#error").show();
                return false;
            }

            // æ ¹æ®è®¾å¤‡è°ƒæ•´ç”»å¸ƒå¤§å°
            var isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
            var width = isMobile ? window.innerWidth : canvas.width();
            var height = isMobile ? window.innerHeight : canvas.height();
            
            // è®¾ç½®ç”»å¸ƒå°ºå¯¸
            canvas.attr("width", width);
            canvas.attr("height", height);
            
            // ç›‘å¬çª—å£å¤§å°å˜åŒ–
            $(window).resize(function() {
                if(isMobile) {
                    canvas.attr("width", window.innerWidth);
                    canvas.attr("height", window.innerHeight);
                }
            });

            // æ£€æµ‹æ˜¯å¦ä¸ºç§»åŠ¨è®¾å¤‡
            var isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
            // è®¡ç®—ç¼©æ”¾æ¯”ä¾‹
            var scale = isMobile ? 0.6 : 1;
            var centerX = width / 2;
            var bottomY = height - height * 0.1;

            var opts = {
                seed: {
                    x: centerX,
                    color: "rgb(190, 26, 37)",
                    scale: 2 * scale
                },
                branch: [
                    // ä½¿ç”¨ç›¸å¯¹ä½ç½®è®¡ç®—ï¼Œé€‚åº”ä¸åŒå±å¹•å¤§å°
                    [centerX + 35 * scale, height - 20, 
                     centerX + 70 * scale, height/3, 
                     centerX, height/4, 
                     30 * scale, 100, [
                        [centerX + 40 * scale, height/1.5, 
                         centerX - 45 * scale, height/1.8, 
                         centerX - 160 * scale, height/1.8, 
                         13 * scale, 100, [
                            [centerX - 50 * scale, height/1.7, 
                             centerX - 66 * scale, height/1.7, 
                             centerX - 106 * scale, height/1.8, 
                             2 * scale, 40]
                        ]],
                        [centerX + 50 * scale, height/1.6, 
                         centerX + 100 * scale, height/2.2, 
                         centerX + 180 * scale, height/2.2, 
                         12 * scale, 100, [
                            [centerX + 78 * scale, height/1.8, 
                             centerX + 148 * scale, height/1.7, 
                             centerX + 161 * scale, height/1.7, 
                             3 * scale, 80]
                        ]],
                        [centerX + 39 * scale, height/2.7, 
                         centerX + 37 * scale, height/3, 
                         centerX + 34 * scale, height/3.5, 
                         3 * scale, 40],
                        [centerX + 46 * scale, height/1.8, 
                         centerX - 87 * scale, height/3, 
                         centerX - 172 * scale, height/3, 
                         9 * scale, 80, [
                            [centerX - 73 * scale, height/2.5, 
                             centerX - 117 * scale, height/3, 
                             centerX - 129 * scale, height/3.7, 
                             2 * scale, 40],
                            [centerX - 2 * scale, height/2.2, 
                             centerX - 65 * scale, height/2.3, 
                             centerX - 105 * scale, height/2.2, 
                             4 * scale, 60]
                        ]],
                        [centerX + 46 * scale, height/2.1, 
                         centerX + 108 * scale, height/3, 
                         centerX + 178 * scale, height/3.4, 
                         6 * scale, 100, [
                            [centerX + 90 * scale, height/2.4, 
                             centerX + 146 * scale, height/2.6, 
                             centerX + 148 * scale, height/2.7, 
                             2 * scale, 80]
                        ]]
                    ]]
                ],
                bloom: {
                    num: isMobile ? 350 : 700, // ç§»åŠ¨è®¾å¤‡ä¸Šå‡å°‘èŠ±ç“£æ•°é‡
                    width: width,
                    height: height * 0.9,
                },
                footer: {
                    width: width,
                    height: 5,
                    speed: isMobile ? 10 : 20, // ç§»åŠ¨è®¾å¤‡ä¸Šé™ä½é€Ÿåº¦
                }
            }

            var tree = new Tree(canvas[0], width, height, opts);
            var seed = tree.seed;
            var foot = tree.footer;
            var hold = 1;

            canvas.click(function (e) {
                var offset = canvas.offset(), x, y;
                x = e.pageX - offset.left;
                y = e.pageY - offset.top;
                if (seed.hover(x, y)) {
                    hold = 0;
                    canvas.unbind("click");
                    canvas.unbind("mousemove");
                    canvas.removeClass('hand');
                    
                    // ç‚¹å‡»ä¿¡å°åæ’­æ”¾èƒŒæ™¯éŸ³ä¹
                    var audio = document.getElementById('media');
                    audio.play().catch(function(err) {
                        console.log('æ’­æ”¾å¤±è´¥:', err);
                    });
                }
            }).mousemove(function (e) {
                var offset = canvas.offset(), x, y;
                x = e.pageX - offset.left;
                y = e.pageY - offset.top;
                canvas.toggleClass('hand', seed.hover(x, y));
            });

            var seedAnimate = eval(Jscex.compile("async", function () {
                seed.draw();
                while (hold) {
                    $await(Jscex.Async.sleep(10));
                }
                while (seed.canScale()) {
                    seed.scale(0.95);
                    $await(Jscex.Async.sleep(10));
                }
                while (seed.canMove()) {
                    seed.move(0, 2);
                    foot.draw();
                    $await(Jscex.Async.sleep(10));
                }
            }));

            var growAnimate = eval(Jscex.compile("async", function () {
                do {
                    tree.grow();
                    $await(Jscex.Async.sleep(10));
                } while (tree.canGrow());
            }));

            var flowAnimate = eval(Jscex.compile("async", function () {
                do {
                    tree.flower(2);
                    $await(Jscex.Async.sleep(10));
                } while (tree.canFlower());
            }));

            var moveAnimate = eval(Jscex.compile("async", function () {
                tree.snapshot("p1", 240, 0, 610, 680);
                while (tree.move("p1", 500, 0)) {
                    foot.draw();
                    $await(Jscex.Async.sleep(10));
                }
                foot.draw();
                tree.snapshot("p2", 500, 0, 610, 680);

                // ä¼šæœ‰é—ªçƒä¸å¾—æ„è¿™æ ·åš, (ï¼ï¹ï¼œ)
                canvas.parent().css("background", "url(" + tree.toDataURL('image/png') + ")");
                canvas.css("background", "#ffc0cb");
                $await(Jscex.Async.sleep(300));
                canvas.css("background", "none");
            }));

            var jumpAnimate = eval(Jscex.compile("async", function () {
                var ctx = tree.ctx;
                while (true) {
                    tree.ctx.clearRect(0, 0, width, height);
                    tree.jump();
                    foot.draw();
                    $await(Jscex.Async.sleep(25));
                }
            }));

            var textAnimate = eval(Jscex.compile("async", function () {
                var together = new Date();
                together.setFullYear(2025, 3, 17);
                together.setHours(0);
                together.setMinutes(0);
                together.setSeconds(0);
                together.setMilliseconds(0);

                $("#code").show().typewriter();
                $("#clock-box").fadeIn(500);
                while (true) {
                    timeElapse(together);
                    $await(Jscex.Async.sleep(1000));
                }
            }));

            var runAsync = eval(Jscex.compile("async", function () {
                $await(seedAnimate());
                $await(growAnimate());
                $await(flowAnimate());
                $await(moveAnimate());

                textAnimate().start();

                $await(jumpAnimate());
            }));

            runAsync().start();
        })();
    </script>



    <!-- æ·»åŠ ç§»åŠ¨è®¾å¤‡é€‚é…æ ·å¼ -->
    <style>
        @media screen and (max-width: 428px) {
            body {
                font-size: 16px;
                margin: 0;
                padding: 0;
                overflow-x: hidden;
            }

            #main {
                width: 100% !important;
                height: 100vh !important;
            }

            #wrap {
                width: 100% !important;
                height: 100vh !important;
                margin: 0 !important;
                position: relative !important;
            }

            #text {
                width: 90% !important;
                height: auto !important;
                left: 5% !important;
                top: 50px !important;
                position: absolute !important;
                z-index: 2 !important;
            }

            #code {
                font-size: 18px !important;
                line-height: 1.6 !important;
                padding: 20px !important;
                background: rgba(255, 255, 255, 0.85) !important;
                border-radius: 15px !important;
                box-shadow: 0 2px 10px rgba(0,0,0,0.1) !important;
                margin: 0 auto !important;
                width: 100% !important;
                box-sizing: border-box !important;
            }

            .say {
                font-size: 20px !important;
                margin-bottom: 15px !important;
                color: #333 !important;
                font-weight: 500 !important;
            }

            #clock-box {
                width: 90% !important;
                left: 5% !important;
                bottom: 30px !important;
                top: auto !important;
                position: fixed !important;
                z-index: 2 !important;
                background: rgba(255, 255, 255, 0.85) !important;
                padding: 15px !important;
                border-radius: 15px !important;
                box-shadow: 0 2px 10px rgba(0,0,0,0.1) !important;
                text-align: center !important;
                box-sizing: border-box !important;
            }

            #clock {
                margin: 0 auto !important;
                font-size: 24px !important;
                text-align: center !important;
            }

            #canvas {
                position: fixed !important;
                top: 0 !important;
                left: 0 !important;
                width: 100% !important;
                height: 100% !important;
                z-index: 1 !important;
            }

            .space {
                margin-right: 0 !important;
            }

            #loading {
                z-index: 9999 !important;
            }
        }
    </style>
</body>

</html>